<<<<<<< HEAD
# ğŸ¢ Meeting Room Booking â€” Backend

A production-ready Node.js + Express REST API with SQLite database.
The frontend is a single-page app served by the same server.

---

## ğŸ“ Project Structure

```
mrb-backend/
â”œâ”€â”€ server.js              â† Entry point
â”œâ”€â”€ package.json
â”œâ”€â”€ render.yaml            â† Render.com deployment config
â”œâ”€â”€ .env.example           â† Copy to .env for local dev
â”œâ”€â”€ .gitignore
â”‚
â”œâ”€â”€ db/
â”‚   â””â”€â”€ database.js        â† SQLite schema + seeding
â”‚
â”œâ”€â”€ middleware/
â”‚   â””â”€â”€ auth.js            â† JWT verification
â”‚
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.js            â† Login, change-password, /me
â”‚   â”œâ”€â”€ users.js           â† CRUD users (admin + self-edit)
â”‚   â”œâ”€â”€ rooms.js           â† CRUD rooms + availability
â”‚   â”œâ”€â”€ bookings.js        â† Create, approve, reject, cancel
â”‚   â”œâ”€â”€ notifications.js   â† Read/mark notifications
â”‚   â”œâ”€â”€ analytics.js       â† Dashboard stats + export data
â”‚   â””â”€â”€ settings.js        â† EmailJS config stored in DB
â”‚
â””â”€â”€ public/
    â””â”€â”€ index.html         â† Full frontend (API-connected)
```

---

## ğŸ–¥ï¸ Run Locally

### 1. Install Node.js (v18+)
Download from https://nodejs.org

### 2. Setup project

```bash
cd mrb-backend
npm install
cp .env.example .env
```

### 3. Edit `.env`

```env
PORT=3000
JWT_SECRET=your_long_random_secret_here
ADMIN_EMAIL=admin@company.com
ADMIN_PASSWORD=admin@123
```

### 4. Start the server

```bash
npm start
# or for auto-restart on changes:
npm run dev
```

### 5. Open browser

Go to **http://localhost:3000**

Login with your admin credentials from `.env`.

---

## ğŸš€ Deploy to Render.com (Free Hosting â€” Recommended)

### Step 1 â€” Push to GitHub

```bash
# In the mrb-backend folder:
git init
git add .
git commit -m "Initial commit"
```

Create a repo on https://github.com/new, then:

```bash
git remote add origin https://github.com/YOUR_USERNAME/meeting-room-booking.git
git push -u origin main
```

### Step 2 â€” Create Render account

Go to https://render.com and sign up for free.

### Step 3 â€” New Web Service

1. Click **"New +"** â†’ **"Web Service"**
2. Connect your GitHub account
3. Select your `meeting-room-booking` repository
4. Render will auto-detect the `render.yaml` â€” click **"Apply"**

### Step 4 â€” Set Environment Variables

In Render dashboard â†’ your service â†’ **Environment**:

| Key | Value |
|-----|-------|
| `ADMIN_EMAIL` | your-admin@company.com |
| `ADMIN_PASSWORD` | YourSecurePassword123 |

> `JWT_SECRET` is auto-generated by Render (secure âœ…)

### Step 5 â€” Deploy

Click **"Save Changes"** â†’ Render builds and deploys automatically.

Your app will be live at:
```
https://meeting-room-booking.onrender.com
```

> âš ï¸ Free tier spins down after 15 min of inactivity â€” first load may take ~30s.

---

## ğŸŒ API Reference

All endpoints are prefixed with `/api/`.
Protected routes require: `Authorization: Bearer <token>`

### Auth
| Method | Path | Auth | Description |
|--------|------|------|-------------|
| POST | `/auth/login` | âŒ | Login, returns JWT token |
| GET | `/auth/me` | âœ… | Get current user info |
| POST | `/auth/change-password` | âœ… | Change own password |

### Users
| Method | Path | Auth | Description |
|--------|------|------|-------------|
| GET | `/users` | Admin | List all users |
| GET | `/users/:id` | âœ… | Get user (self or admin) |
| POST | `/users` | Admin | Create user |
| PATCH | `/users/:id` | âœ… | Edit user (limited fields for self) |
| PATCH | `/users/:id/toggle-active` | Admin | Activate/deactivate |
| PATCH | `/users/:id/reset-password` | Admin | Reset password |
| DELETE | `/users/:id` | Admin | Delete user |

### Rooms
| Method | Path | Auth | Description |
|--------|------|------|-------------|
| GET | `/rooms` | âœ… | List all rooms |
| GET | `/rooms/:id/availability?date=YYYY-MM-DD` | âœ… | Hourly slot availability |
| POST | `/rooms` | Admin | Create room |
| PATCH | `/rooms/:id` | Admin | Edit room |
| PATCH | `/rooms/:id/toggle-block` | Admin | Block/unblock |
| DELETE | `/rooms/:id` | Admin | Delete room |

### Bookings
| Method | Path | Auth | Description |
|--------|------|------|-------------|
| GET | `/bookings` | âœ… | My bookings (admin: all) |
| GET | `/bookings/pending-count` | Admin | Count for sidebar badge |
| GET | `/bookings/:id` | âœ… | Single booking |
| POST | `/bookings` | âœ… | Create booking |
| PATCH | `/bookings/:id/cancel` | âœ… | Cancel booking |
| PATCH | `/bookings/:id/approve` | Admin | Approve pending |
| PATCH | `/bookings/:id/reject` | Admin | Reject with reason |

### Notifications
| Method | Path | Auth | Description |
|--------|------|------|-------------|
| GET | `/notifications` | âœ… | Get notifications + unread count |
| PATCH | `/notifications/mark-all-read` | âœ… | Mark all as read |

### Analytics & Export
| Method | Path | Auth | Description |
|--------|------|------|-------------|
| GET | `/analytics/summary` | Admin | Stats for charts |
| GET | `/analytics/export` | Admin | All rows for CSV/Excel |

### Settings
| Method | Path | Auth | Description |
|--------|------|------|-------------|
| GET | `/settings` | Admin | Get all settings (EmailJS config) |
| PUT | `/settings` | Admin | Save settings |

---

## ğŸ”’ Security Notes

- Passwords hashed with bcrypt (10 rounds)
- JWT tokens expire after 8 hours
- Admin-only routes are enforced server-side
- SQLite WAL mode for safe concurrent access
- CORS configured via environment variable

---

## ğŸ“§ Email Notifications (EmailJS)

After deploying, go to **Email Settings** in the app sidebar:

1. Create free account at https://emailjs.com
2. Add email service (Gmail/Outlook)
3. Create email template using variables:
   - `{{booked_by}}`, `{{room_name}}`, `{{meeting_date}}`
   - `{{start_time}}`, `{{end_time}}`, `{{food}}`, `{{veg_nonveg}}`
   - `{{status}}`, `{{purpose}}`, `{{remarks}}`
4. Copy Service ID, Template ID, Public Key
5. Paste into Email Settings in the app â†’ Save

---

## ğŸ› ï¸ Tech Stack

| Layer | Technology |
|-------|------------|
| Runtime | Node.js 18+ |
| Framework | Express 4 |
| Database | SQLite (better-sqlite3) |
| Auth | JWT (jsonwebtoken) |
| Passwords | bcryptjs |
| Frontend | Vanilla JS SPA |
| Charts | Chart.js |
| Excel | SheetJS (xlsx) |
| Email | EmailJS |
=======
# MeetingBooking_test2
>>>>>>> 025c439680807ebc9bc8e72eb07bb42de97d50e6
